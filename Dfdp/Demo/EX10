*          EXERCISE 10

        IDT     'EX10'
*
*       THIS PROGRAM INVERTS THE SIGNAL SPECTRUM BY MODULATING AT
*       THE NYQUIST FREQUENCY; I.E., MULTIPLYING BY (-1)^N
*
*       DATA MEMORY LOCATION ASSIGNMENTS
*
RATE    EQU     0       ADDR 00 CONTAINS CLOCK RATE
MODE    EQU     1       ADDR 01 CONTAINS CONTROL MODE
MASK    EQU     2       ADDR 02 CONTAINS MASK VALUE
XIN     EQU     3       CURRENT DATA SAMPLE
TEMP    EQU     4
MFLIP   EQU     5       TOGGLING MASK
*
        AORG    0       START PROGRAM AT ADDRESS 0
        B       START   JUMP AROUND DATA
*
*       DATA MEMORY INITIALIZATION VALUES
*
DRATE   DATA    >0200   SAMPLING RATE
DMODE   DATA    >000A   MODE
DMASK   DATA    >FFFF   MASK VALUE
*
*       THE PROGRAM
*
START   LDPK    0       SET DATA PAGE POINTER TO 0
        SOVM
        DINT
        LACK    DRATE   LOAD
        TBLR    RATE    CLOCK RATE,
        LACK    DMODE   A/D MODE,
        TBLR    MODE    AND
        LACK    DMASK   MASK
        TBLR    MASK    INTO DATA MEMORY
        LAC     MASK
        SACL    MFLIP
*
*
        OUT     MODE,PA0        SET AIB SAMPLING MODE
        OUT     RATE,PA1        SET SAMPLING RATE

*
LOOP    BIOZ    FLIP    CONVERSION COMPLETE?
        B       LOOP    WAIT UNTIL CONVERSION COMPLETE
*
        FLIP    IN      XIN,PA2 READ IN DATA SAMPLE
        LAC     MFLIP
        XOR     MASK    INVERT THE TOGGLE MASK
        SACL    MFLIP
        XOR     XIN     TOGGLE DATA (MULTIPLY BY (-1)N)
        SACL    TEMP
        OUT     TEMP,PA2        WRITE OUT SPECTRALLY REVERSED DATA
        B       LOOP    DO THIS FOREVER
        END

